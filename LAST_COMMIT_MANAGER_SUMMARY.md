# ملخص آخر تحديث (للإدارة)

- **Commit**: `a590f5da670220e28b063b75a834f800d0a60379`
- **حجم التغيير**: 18 ملف — **+1326** إضافة / **-403** حذف

## ماذا تم تحسينه؟ (مختصر مفيد)

- **تقليل أخطاء إدخال البيانات** عبر تشديد التحقق من:
  - رقم الجوال (9 أرقام ويبدأ بـ 5).
  - رقم الهوية (10 أرقام).
  - رقم التأشيرة (قواعد/قيود إدخال لمنع الحروف والالتزام ببداية محددة).
- **تحسين تجربة إدخال المدينة** (بحث + اختيار سريع) في أكثر من نموذج باستخدام Dropdown قابل للبحث بدل القوائم الطويلة.
- **إضافة ميزة حذف عميل بصلاحية**:
  - ظهور زر “حذف” فقط للمستخدمين الذين لديهم صلاحية.
  - نافذة تأكيد قبل الحذف.
  - Endpoint جديد للحذف على السيرفر مع تسجيل الحدث.
- **تحسينات في صفحة تتبع الطلب**:
  - إضافة/إظهار ملفات الطلب (مثل مستند الطلب/العقد) ضمن بيانات الطلب.
  - تحسين حذف “ملف الاستلام” مع تأكيد ورسائل نجاح/خطأ واضحة.
- **تحسين رفع صور العاملات في إضافة عاملة جديدة**:
  - التحول لحقول صور أوضح (صورة شخصية/صورة كاملة).
  - معاينة فورية قبل الرفع.
  - تقييد النوع إلى JPEG لتقليل مشاكل التوافق.
  - استخدام مسار رفع مخصص للصور.
- **تحسينات تشغيلية صغيرة لكنها مؤثرة**:
  - منع ظهور صفوف فاضية في قائمة الحجوزات (تنظيف العرض).
  - جعل زر “إضافة مهمة” ظاهر لكل المستخدمين المسجلين.
  - تحسين أمان/ثبات API إضافة المهام (تحقق توكن أفضل وتحديد assignedBy بشكل صحيح).
  - تحويل صفحة “الطلبات الجديدة” لجلب بيانات على السيرفر بدل إعادة توليد ثابتة (لتقليل مشاكل بيانات قديمة).
  - في بيانات العاملات: ضبط الراتب ليكون أرقام فقط حتى لو المستخدم كتب بأرقام عربية.
  - في “القادمات للسكن”: إضافة قيمة للمستحقات واعتبارها افتراضياً (لا) لتفادي إدخالات خاطئة.

## الأثر المتوقع على الشغل

- **أسرع في إدخال البيانات** (اختيار المدينة بالبحث + معاينة الصور).
- **أخطاء أقل** في أرقام الهاتف/الهوية/التأشيرة/الراتب.
- **صلاحيات أوضح** (الحذف مرتبط بصلاحية فعلية ومؤكد بنافذة).
- **متابعة الطلبات أسهل** (تحسين التعامل مع الملفات داخل تتبع الطلب).

## نقاط تحتاج انتباه (مخاطر/ملاحظات)

- **رقم التأشيرة**: تم تشديد القواعد في أكثر من مكان داخل النظام؛ يُفضّل التأكد أن **نفس الصيغة** مطبقة في كل الشاشات حتى لا يحصل تعارض أو رفض إدخال.
- **حذف العميل**: إجراء نهائي (لا رجوع)، لذلك الاعتماد على صلاحية “حذف” ونافذة التأكيد مهم—يفضل متابعة أول أيام التشغيل للتأكد أن الصلاحيات مضبوطة.

## اختبار سريع مقترح (5 دقائق)

- إضافة عميل جديد:
  - جوال صحيح: `5XXXXXXXX`، وخطأ: لا يبدأ بـ 5 أو أقل/أكثر من 9.
  - اختيار مدينة من القائمة بالبحث.
  - اختيار “مصدر العميل: أخرى” وإدخال مصدر مخصص.
  - تجربة رقم تأشيرة وفق القواعد الحالية.
- صفحة العملاء:
  - مستخدم عنده صلاحية حذف: يظهر زر حذف + نافذة تأكيد + يتم الحذف.
  - مستخدم بدون صلاحية: لا يظهر زر حذف.
- إضافة عاملة جديدة:
  - رفع صورة JPEG ومعاينة قبل الرفع.
- تتبع طلب:
  - حذف ملف الاستلام يظهر تأكيد ورسالة نجاح/خطأ.
